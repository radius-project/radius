// ------------------------------------------------------------
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.
// ------------------------------------------------------------

package azure

import (
	"fmt"
	"path/filepath"

	"gopkg.in/ini.v1"
)

//
// <AiDoc: The following comments were generated by OpenAI explaining the code as it existed at the time of this commit>
//	This function is attempting to load the default resource group from the Azure CLI configuration. It first finds the 
//	profile path, then the config path, and then reads the config file. Finally, it returns the default resource group from 
//	the config file.
//
// </AiDoc: End of OpenAI comments>
func LoadDefaultResourceGroupFromConfig() (string, error) {
	profilePath, err := ProfilePath()
	if err != nil {
		return "", fmt.Errorf("cannot load azure-cli config: %v", err)
	}
	configPath := filepath.Join(filepath.Dir(profilePath), "config")

	cfg, err := ini.Load(configPath)
	if err != nil {
		return "", fmt.Errorf("failed to read config file: %v", err)
	}

	return cfg.Section("defaults").Key("group").String(), nil
}
